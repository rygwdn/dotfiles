# Worktree-util zsh integration

# Full featured path segments with worktree-util shortpath
function update_path_segments() {
    local segments=($(worktree-util shortpath -s prefix,shortened,normal "$PWD" 2>/dev/null))
    export WORKTREE_PATH_PREFIX="$segments[1]"
    export WORKTREE_PATH_SHORTENED="$segments[2]"
    export WORKTREE_PATH_NORMAL="$segments[3]"
}

# Hook into directory change
if [[ -n "$ZSH_VERSION" ]]; then
    autoload -U add-zsh-hook
    add-zsh-hook chpwd update_path_segments
fi

# Initialize path segments
update_path_segments

{{#if init_navigate}}
# Navigation function
{{navigate_cmd}} () {
    local paths
    paths=($({{exe_path}} nav "$@"))
    if [[ ${#paths[@]} -gt 0 ]]; then
        cd ${paths[@]}
    fi
}
{{/if}}

{{#if init_code}}
# Code function
{{code_cmd}} () {
    local paths
    paths=($({{exe_path}} nav --multi "$@"))
    if [[ ${#paths[@]} -gt 0 ]]; then
        code ${paths[@]}
    fi
}
{{/if}} 