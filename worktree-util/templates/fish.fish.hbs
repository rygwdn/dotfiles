function update_path_segments --on-variable PWD
    set -l segments (worktree-util shortpath -s prefix,shortened,normal "$PWD" 2>/dev/null)
    set -g WORKTREE_PATH_PREFIX $segments[1]
    set -g WORKTREE_PATH_SHORTENED $segments[2] 
    set -g WORKTREE_PATH_NORMAL $segments[3]
end

update_path_segments

{{#if init_navigate}}
function {{navigate_cmd}}
    set -l paths ({{exe_path}} nav $argv)
    if test (count $paths) -gt 0
        cd $paths
    end
end
{{/if}}

{{#if init_code}}
function {{code_cmd}}
    set -l paths ({{exe_path}} nav --multi $argv)
    if test (count $paths) -gt 0
        code $paths
    end
end
{{/if}} 